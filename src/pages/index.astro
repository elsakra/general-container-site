---
import BaseLayout from '../layouts/BaseLayout.astro';
import siteData from '../data/site.json';
import { getCollection } from 'astro:content';

let products = [];
let testimonials = [];
try {
  products = await getCollection('products');
  products = products.sort((a, b) => (a.data.order || 0) - (b.data.order || 0)).slice(0, 6);
} catch (e) {}
try {
  testimonials = await getCollection('testimonials');
  testimonials = testimonials.filter(t => t.data.featured).slice(0, 3);
} catch (e) {}

const { hero, sections, company, socialProof } = siteData;
---

<BaseLayout>
  <!-- Hero Section -->
  <section class="relative bg-slate-900 overflow-hidden">
    <div class="absolute inset-0 opacity-20">
      {hero.backgroundImage ? (
        <img 
          src={hero.backgroundImage}
          alt=""
          class="w-full h-full object-cover"
        />
      ) : (
        <div class="w-full h-full bg-gradient-to-br from-slate-800 to-slate-900"></div>
      )}
    </div>
    <div class="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-20 lg:py-32">
      <div class="max-w-3xl">
        <h1 class="text-4xl sm:text-5xl lg:text-6xl font-display font-bold text-white leading-tight">
            {hero.headline}
          </h1>
        <p class="mt-6 text-xl text-slate-300 leading-relaxed">
            {hero.subheadline}
          </p>
          
        <!-- CTAs -->
        <div class="mt-10 flex flex-col sm:flex-row gap-4">
          <a 
            href={hero.cta?.href || '/contact'}
            class="inline-flex items-center justify-center px-8 py-4 bg-accent-500 text-white text-lg font-bold rounded-lg hover:bg-accent-600 transition-all shadow-lg"
          >
            {hero.cta?.label || 'Request a Quote'}
          </a>
          {hero.secondaryCta && (
            <a 
              href={hero.secondaryCta.href}
              class="inline-flex items-center justify-center px-8 py-4 bg-white/10 text-white text-lg font-bold rounded-lg hover:bg-white/20 transition-all border border-white/30"
            >
              {hero.secondaryCta.label}
            </a>
          )}
        </div>
      </div>
    </div>
  </section>

  <!-- Trust Indicators -->
  {socialProof && (
    <section class="bg-white border-b border-slate-200">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <p class="text-center text-sm font-medium text-slate-500 mb-6">
          {socialProof.trustedBy || 'Trusted by businesses nationwide'}
        </p>
        {socialProof.stats && (
          <div class="grid grid-cols-2 md:grid-cols-3 gap-8">
          {socialProof.stats.map((stat) => (
            <div class="text-center">
                <div class="text-3xl lg:text-4xl font-display font-bold text-brand-700">
                {stat.value}
              </div>
                <div class="mt-1 text-slate-600 text-sm font-medium">
                {stat.label}
              </div>
            </div>
          ))}
        </div>
        )}
      </div>
    </section>
  )}

  <!-- Products Section -->
  <section class="py-16 lg:py-24 bg-slate-50">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-12">
        <span class="text-sm font-bold uppercase tracking-wider text-brand-600">Our Products</span>
        <h2 class="mt-2 text-3xl lg:text-4xl font-display font-bold text-slate-900">
          {sections.products?.headline || 'Product Categories'}
          </h2>
        <p class="mt-4 text-lg text-slate-600 max-w-2xl mx-auto">
          {sections.products?.description || 'Explore our comprehensive selection of industrial containers and packaging solutions.'}
        </p>
        </div>
        
      {products.length > 0 ? (
        <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-6">
          {products.map((product) => (
            <a 
              href={`/products/${product.slug}`}
              class="group bg-white p-6 rounded-xl shadow-sm hover:shadow-lg transition-all border border-slate-200 hover:border-brand-300"
            >
              {product.data.image ? (
                <div class="aspect-[4/3] rounded-lg overflow-hidden bg-slate-100 mb-4">
                  <img 
                    src={product.data.image}
                    alt={product.data.title}
                    class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
                  />
                </div>
              ) : (
                <div class="aspect-[4/3] rounded-lg bg-brand-100 flex items-center justify-center mb-4">
                  <svg class="w-16 h-16 text-brand-300" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z" clip-rule="evenodd" />
                  </svg>
                </div>
              )}
              <h3 class="text-xl font-display font-bold text-slate-900 group-hover:text-brand-700 transition-colors">
                {product.data.title}
              </h3>
              <p class="mt-2 text-slate-600 text-sm line-clamp-2">
                {product.data.shortDescription || product.data.description}
              </p>
              <span class="mt-4 inline-flex items-center gap-1 text-brand-600 text-sm font-semibold">
                View Products
                <svg class="w-4 h-4 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                  </svg>
              </span>
            </a>
          ))}
        </div>
      ) : (
        <!-- Placeholder Products -->
        <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-6">
          {[
            { title: 'Steel Drums', desc: 'Open-head and closed-head steel drums for industrial storage and shipping' },
            { title: 'Plastic Containers', desc: 'Durable polyethylene drums and containers in various sizes' },
            { title: 'IBCs & Totes', desc: 'Intermediate bulk containers for efficient liquid storage and transport' },
            { title: 'Pails & Cans', desc: 'Metal and plastic pails for smaller volume packaging needs' },
            { title: 'Fiber Drums', desc: 'Eco-friendly fiber drums for dry product storage' },
            { title: 'Accessories', desc: 'Lids, liners, fittings, and other container accessories' },
          ].map((product) => (
            <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200">
              <div class="aspect-[4/3] rounded-lg bg-brand-100 flex items-center justify-center mb-4">
                <svg class="w-16 h-16 text-brand-300" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z" clip-rule="evenodd" />
                  </svg>
              </div>
              <h3 class="text-xl font-display font-bold text-slate-900">{product.title}</h3>
              <p class="mt-2 text-slate-600 text-sm">{product.desc}</p>
            </div>
          ))}
        </div>
      )}
      
      <div class="mt-12 text-center">
        <a 
          href="/products"
          class="inline-flex items-center gap-2 px-6 py-3 bg-brand-700 text-white font-bold rounded-lg hover:bg-brand-800 transition-colors"
        >
          View All Products
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
          </svg>
        </a>
        </div>
      </div>
    </section>

  <!-- About Section -->
  <section class="py-16 lg:py-24 bg-white">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="grid lg:grid-cols-2 gap-12 items-center">
        <div>
          <span class="text-sm font-bold uppercase tracking-wider text-brand-600">About Us</span>
          <h2 class="mt-2 text-3xl lg:text-4xl font-display font-bold text-slate-900">
            {sections.about?.headline || 'Your Industrial Packaging Partner'}
          </h2>
          <p class="mt-6 text-lg text-slate-600 leading-relaxed">
            {sections.about?.content}
          </p>
          
          {sections.about?.values && (
            <div class="mt-8 space-y-4">
              {sections.about.values.map((value) => (
                <div class="flex items-start gap-4">
                  <div class="flex-shrink-0 w-8 h-8 mt-0.5 rounded-full bg-accent-100 flex items-center justify-center">
                    <svg class="w-4 h-4 text-accent-600" fill="currentColor" viewBox="0 0 20 20">
                      <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                    </svg>
                  </div>
                  <div>
                    <h3 class="font-bold text-slate-900">{value.title}</h3>
                    <p class="text-slate-600 text-sm">{value.description}</p>
                  </div>
                </div>
              ))}
            </div>
          )}
          
          <div class="mt-8">
            <a href="/about" class="inline-flex items-center gap-2 text-brand-700 font-bold hover:text-brand-800 transition-colors">
              Learn More About Us
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
              </svg>
            </a>
          </div>
        </div>
        
        <div class="relative">
          {sections.about?.image ? (
            <img 
              src={sections.about.image}
              alt="Our Warehouse"
              class="rounded-2xl shadow-xl"
            />
          ) : (
            <div class="aspect-[4/3] rounded-2xl bg-brand-100 flex items-center justify-center">
              <svg class="w-24 h-24 text-brand-300" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M4 4a2 2 0 012-2h8a2 2 0 012 2v12a1 1 0 110 2h-3a1 1 0 01-1-1v-2a1 1 0 00-1-1H9a1 1 0 00-1 1v2a1 1 0 01-1 1H4a1 1 0 110-2V4zm3 1h2v2H7V5zm2 4H7v2h2V9zm2-4h2v2h-2V5zm2 4h-2v2h2V9z" clip-rule="evenodd" />
              </svg>
            </div>
          )}
        </div>
      </div>
    </div>
  </section>

  <!-- Why Choose Us -->
  <section class="py-16 lg:py-24 bg-brand-900 text-white">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center mb-12">
        <h2 class="text-3xl lg:text-4xl font-display font-bold text-white">
          Why Choose Us?
        </h2>
      </div>
      
      <div class="grid sm:grid-cols-2 lg:grid-cols-4 gap-8">
        {[
          { icon: 'inventory', title: 'Large Inventory', desc: 'Thousands of products ready to ship from our distribution centers' },
          { icon: 'price', title: 'Competitive Pricing', desc: 'Volume discounts and wholesale rates for bulk orders' },
          { icon: 'shipping', title: 'Fast Shipping', desc: 'Quick turnaround times with nationwide delivery' },
          { icon: 'support', title: 'Expert Support', desc: 'Knowledgeable staff to help you find the right solution' },
        ].map((feature) => (
          <div class="text-center">
            <div class="mx-auto w-16 h-16 flex items-center justify-center rounded-full bg-brand-800">
              {feature.icon === 'inventory' && (
                <svg class="w-8 h-8 text-accent-400" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M4 4a2 2 0 012-2h8a2 2 0 012 2v12a1 1 0 110 2h-3a1 1 0 01-1-1v-2a1 1 0 00-1-1H9a1 1 0 00-1 1v2a1 1 0 01-1 1H4a1 1 0 110-2V4z" clip-rule="evenodd" />
                </svg>
              )}
              {feature.icon === 'price' && (
                <svg class="w-8 h-8 text-accent-400" fill="currentColor" viewBox="0 0 20 20">
                  <path d="M8.433 7.418c.155-.103.346-.196.567-.267v1.698a2.305 2.305 0 01-.567-.267C8.07 8.34 8 8.114 8 8c0-.114.07-.34.433-.582zM11 12.849v-1.698c.22.071.412.164.567.267.364.243.433.468.433.582 0 .114-.07.34-.433.582a2.305 2.305 0 01-.567.267z" />
                  <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-13a1 1 0 10-2 0v.092a4.535 4.535 0 00-1.676.662C6.602 6.234 6 7.009 6 8c0 .99.602 1.765 1.324 2.246.48.32 1.054.545 1.676.662v1.941c-.391-.127-.68-.317-.843-.504a1 1 0 10-1.51 1.31c.562.649 1.413 1.076 2.353 1.253V15a1 1 0 102 0v-.092a4.535 4.535 0 001.676-.662C13.398 13.766 14 12.991 14 12c0-.99-.602-1.765-1.324-2.246A4.535 4.535 0 0011 9.092V7.151c.391.127.68.317.843.504a1 1 0 101.511-1.31c-.563-.649-1.413-1.076-2.354-1.253V5z" clip-rule="evenodd" />
                </svg>
              )}
              {feature.icon === 'shipping' && (
                <svg class="w-8 h-8 text-accent-400" fill="currentColor" viewBox="0 0 20 20">
                  <path d="M8 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM15 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0z" />
                  <path d="M3 4a1 1 0 00-1 1v10a1 1 0 001 1h1.05a2.5 2.5 0 014.9 0H10a1 1 0 001-1V5a1 1 0 00-1-1H3zM14 7a1 1 0 00-1 1v6.05A2.5 2.5 0 0115.95 16H17a1 1 0 001-1v-5a1 1 0 00-.293-.707l-2-2A1 1 0 0015 7h-1z" />
                </svg>
              )}
              {feature.icon === 'support' && (
                <svg class="w-8 h-8 text-accent-400" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-2 0c0 .993-.241 1.929-.668 2.754l-1.524-1.525a3.997 3.997 0 00.078-2.183l1.562-1.562C15.802 8.249 16 9.1 16 10zm-5.165 3.913l1.58 1.58A5.98 5.98 0 0110 16a5.976 5.976 0 01-2.516-.552l1.562-1.562a4.006 4.006 0 001.789.027zm-4.677-2.796a4.002 4.002 0 01-.041-2.08l-.08.08-1.53-1.533A5.98 5.98 0 004 10c0 .954.223 1.856.619 2.657l1.54-1.54zm1.088-6.45A5.974 5.974 0 0110 4c.954 0 1.856.223 2.657.619l-1.54 1.54a4.002 4.002 0 00-2.346.033L7.246 4.668zM12 10a2 2 0 11-4 0 2 2 0 014 0z" clip-rule="evenodd" />
                </svg>
              )}
            </div>
            <h3 class="mt-4 text-lg font-display font-bold text-white">{feature.title}</h3>
            <p class="mt-2 text-blue-200 text-sm">{feature.desc}</p>
            </div>
          ))}
      </div>
    </div>
  </section>

  <!-- Testimonials -->
  <section class="py-16 lg:py-24 bg-slate-50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center mb-12">
        <span class="text-sm font-bold uppercase tracking-wider text-brand-600">Testimonials</span>
        <h2 class="mt-2 text-3xl lg:text-4xl font-display font-bold text-slate-900">
          {sections.testimonials?.headline || 'What Our Customers Say'}
        </h2>
      </div>
      
      {testimonials.length > 0 ? (
        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
          {testimonials.map((testimonial) => (
            <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200">
              <p class="text-slate-600 italic">"{testimonial.body}"</p>
              <div class="mt-4 pt-4 border-t border-slate-100">
                <p class="font-bold text-slate-900">{testimonial.data.author}</p>
                {testimonial.data.company && (
                  <p class="text-slate-500 text-sm">{testimonial.data.company}</p>
                )}
              </div>
            </div>
          ))}
        </div>
      ) : (
        <!-- Placeholder testimonials -->
        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
          {[
            { quote: "Excellent pricing on bulk orders. They've been our go-to supplier for years.", author: "Michael R.", company: "ABC Manufacturing" },
            { quote: "Fast shipping and quality products. Their team is always helpful with product recommendations.", author: "Sarah L.", company: "Midwest Distributors" },
            { quote: "We switched to them for our packaging needs and haven't looked back. Great service!", author: "James T.", company: "Pacific Logistics" },
          ].map((t) => (
            <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200">
              <p class="text-slate-600 italic">"{t.quote}"</p>
              <div class="mt-4 pt-4 border-t border-slate-100">
                <p class="font-bold text-slate-900">{t.author}</p>
                <p class="text-slate-500 text-sm">{t.company}</p>
              </div>
            </div>
          ))}
        </div>
      )}
    </div>
  </section>

  <!-- CTA Section -->
  <section class="py-16 lg:py-20 bg-accent-600">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
      <h2 class="text-3xl lg:text-4xl font-display font-bold text-white">
        {sections.cta?.headline || "Ready to Order?"}
      </h2>
      <p class="mt-4 text-xl text-orange-100">
        {sections.cta?.description || "Contact our sales team for a custom quote on your packaging needs. Volume discounts available."}
      </p>
      <div class="mt-8 flex flex-col sm:flex-row gap-4 justify-center">
        <a 
          href="/contact"
          class="inline-flex items-center justify-center gap-2 px-8 py-4 bg-white text-accent-700 text-lg font-bold rounded-lg hover:bg-slate-100 transition-colors"
        >
          {sections.cta?.cta?.label || 'Request a Quote'}
        </a>
        <a 
          href={`tel:${company.phone?.replace(/[^0-9+]/g, '')}`}
          class="inline-flex items-center justify-center gap-2 px-8 py-4 bg-accent-700 text-white text-lg font-bold rounded-lg hover:bg-accent-800 transition-colors border-2 border-white/20"
        >
          <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
            <path d="M2 3a1 1 0 011-1h2.153a1 1 0 01.986.836l.74 4.435a1 1 0 01-.54 1.06l-1.548.773a11.037 11.037 0 006.105 6.105l.774-1.548a1 1 0 011.059-.54l4.435.74a1 1 0 01.836.986V17a1 1 0 01-1 1h-2C7.82 18 2 12.18 2 5V3z" />
          </svg>
          Call {company.phone}
        </a>
      </div>
    </div>
  </section>
</BaseLayout>
